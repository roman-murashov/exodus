namespace Z80 {

//----------------------------------------------------------------------------------------
//Enumerations
//----------------------------------------------------------------------------------------
enum class Z80::CELineID
{
	RD = 1,
	WR
};

//----------------------------------------------------------------------------------------
enum class Z80::LineID
{
	Reset = 1,
	BusReq,
	BusAck,
	Int,
	Nmi
};

//----------------------------------------------------------------------------------------
enum class Z80::ClockID
{
	Clk = 1
};

//----------------------------------------------------------------------------------------
//Structures
//----------------------------------------------------------------------------------------
struct Z80::LineAccess
{
	LineAccess(unsigned int alineLD, const Data& astate, double aaccessTime)
	:lineID(alineLD), state(astate), accessTime(aaccessTime), clockRateChange(false)
	{}
	LineAccess(unsigned int alineLD, double aclockRate, double aaccessTime)
	:lineID(alineLD), state(0, 0), clockRate(aclockRate), accessTime(aaccessTime), clockRateChange(true)
	{}

	unsigned int lineID;
	bool clockRateChange;
	double clockRate;
	Data state;
	double accessTime;
};

//----------------------------------------------------------------------------------------
struct Z80::CalculateCELineStateContext
{
	CalculateCELineStateContext(bool alineRD, bool alineWR)
	:lineRD(alineRD), lineWR(alineWR)
	{}

	bool lineRD;
	bool lineWR;
};

//----------------------------------------------------------------------------------------
//Register functions
//----------------------------------------------------------------------------------------
Z80Byte Z80::GetA() const
{
	return Z80Byte(afreg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetA(Data& data) const
{
	afreg.GetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetA(const Z80Byte& data)
{
	afreg.SetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetF() const
{
	return Z80Byte(afreg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetF(Data& data) const
{
	afreg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetF(const Z80Byte& data)
{
	afreg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetB() const
{
	return Z80Byte(bcreg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetB(Data& data) const
{
	bcreg.GetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetB(const Z80Byte& data)
{
	bcreg.SetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetC() const
{
	return Z80Byte(bcreg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetC(Data& data) const
{
	bcreg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetC(const Z80Byte& data)
{
	bcreg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetD() const
{
	return Z80Byte(dereg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetD(Data& data) const
{
	dereg.GetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetD(const Z80Byte& data)
{
	dereg.SetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetE() const
{
	return Z80Byte(dereg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetE(Data& data) const
{
	dereg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetE(const Z80Byte& data)
{
	dereg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetH() const
{
	return Z80Byte(hlreg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetH(Data& data) const
{
	hlreg.GetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetH(const Z80Byte& data)
{
	hlreg.SetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetL() const
{
	return Z80Byte(hlreg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetL(Data& data) const
{
	hlreg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetL(const Z80Byte& data)
{
	hlreg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetAF() const
{
	return afreg;
}

//----------------------------------------------------------------------------------------
void Z80::GetAF(Data& data) const
{
	data = afreg;
}

//----------------------------------------------------------------------------------------
void Z80::SetAF(const Z80Word& data)
{
	afreg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetBC() const
{
	return bcreg;
}

//----------------------------------------------------------------------------------------
void Z80::GetBC(Data& data) const
{
	data = bcreg;
}

//----------------------------------------------------------------------------------------
void Z80::SetBC(const Z80Word& data)
{
	bcreg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetDE() const
{
	return dereg;
}

//----------------------------------------------------------------------------------------
void Z80::GetDE(Data& data) const
{
	data = dereg;
}

//----------------------------------------------------------------------------------------
void Z80::SetDE(const Z80Word& data)
{
	dereg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetHL() const
{
	return hlreg;
}

//----------------------------------------------------------------------------------------
void Z80::GetHL(Data& data) const
{
	data = hlreg;
}

//----------------------------------------------------------------------------------------
void Z80::SetHL(const Z80Word& data)
{
	hlreg = data;
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetA2() const
{
	return Z80Byte(af2reg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetA2(Data& data) const
{
	af2reg.GetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetA2(const Z80Byte& data)
{
	af2reg.SetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetF2() const
{
	return Z80Byte(af2reg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetF2(Data& data) const
{
	af2reg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetF2(const Z80Byte& data)
{
	af2reg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetB2() const
{
	return Z80Byte(bc2reg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetB2(Data& data) const
{
	bc2reg.GetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetB2(const Z80Byte& data)
{
	bc2reg.SetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetC2() const
{
	return Z80Byte(bc2reg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetC2(Data& data) const
{
	bc2reg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetC2(const Z80Byte& data)
{
	bc2reg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetD2() const
{
	return Z80Byte(de2reg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetD2(Data& data) const
{
	de2reg.GetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetD2(const Z80Byte& data)
{
	de2reg.SetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetE2() const
{
	return Z80Byte(de2reg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetE2(Data& data) const
{
	de2reg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetE2(const Z80Byte& data)
{
	de2reg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetH2() const
{
	return Z80Byte(hl2reg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetH2(Data& data) const
{
	hl2reg.GetUpperBits(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetH2(const Z80Byte& data)
{
	hl2reg.SetUpperBits(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetL2() const
{
	return Z80Byte(hl2reg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetL2(Data& data) const
{
	hl2reg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetL2(const Z80Byte& data)
{
	hl2reg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetAF2() const
{
	return af2reg;
}

//----------------------------------------------------------------------------------------
void Z80::GetAF2(Data& data) const
{
	data = af2reg;
}

//----------------------------------------------------------------------------------------
void Z80::SetAF2(const Z80Word& data)
{
	af2reg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetBC2() const
{
	return bc2reg;
}

//----------------------------------------------------------------------------------------
void Z80::GetBC2(Data& data) const
{
	data = bc2reg;
}

//----------------------------------------------------------------------------------------
void Z80::SetBC2(const Z80Word& data)
{
	bc2reg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetDE2() const
{
	return de2reg;
}

//----------------------------------------------------------------------------------------
void Z80::GetDE2(Data& data) const
{
	data = de2reg;
}

//----------------------------------------------------------------------------------------
void Z80::SetDE2(const Z80Word& data)
{
	de2reg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetHL2() const
{
	return hl2reg;
}

//----------------------------------------------------------------------------------------
void Z80::GetHL2(Data& data) const
{
	data = hl2reg;
}

//----------------------------------------------------------------------------------------
void Z80::SetHL2(const Z80Word& data)
{
	hl2reg = data;
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetIXHigh() const
{
	return Z80Byte(ixreg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetIXHigh(Data& data) const
{
	ixreg.GetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetIXHigh(const Z80Byte& data)
{
	ixreg.SetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetIXLow() const
{
	return Z80Byte(ixreg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetIXLow(Data& data) const
{
	ixreg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetIXLow(const Z80Byte& data)
{
	ixreg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetIYHigh() const
{
	return Z80Byte(iyreg.GetUpperHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetIYHigh(Data& data) const
{
	iyreg.GetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetIYHigh(const Z80Byte& data)
{
	iyreg.SetUpperHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetIYLow() const
{
	return Z80Byte(iyreg.GetLowerHalf());
}

//----------------------------------------------------------------------------------------
void Z80::GetIYLow(Data& data) const
{
	iyreg.GetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
void Z80::SetIYLow(const Z80Byte& data)
{
	iyreg.SetLowerHalf(data);
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetI() const
{
	return ireg;
}

//----------------------------------------------------------------------------------------
void Z80::GetI(Data& data) const
{
	data = ireg;
}

//----------------------------------------------------------------------------------------
void Z80::SetI(const Z80Byte& data)
{
	ireg = data;
}

//----------------------------------------------------------------------------------------
Z80Byte Z80::GetR() const
{
	return rreg;
}

//----------------------------------------------------------------------------------------
void Z80::GetR(Data& data) const
{
	data = rreg;
}

//----------------------------------------------------------------------------------------
void Z80::SetR(const Z80Byte& data)
{
	rreg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetIX() const
{
	return ixreg;
}

//----------------------------------------------------------------------------------------
void Z80::GetIX(Data& data) const
{
	data = ixreg;
}

//----------------------------------------------------------------------------------------
void Z80::SetIX(const Z80Word& data)
{
	ixreg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetIY() const
{
	return iyreg;
}

//----------------------------------------------------------------------------------------
void Z80::GetIY(Data& data) const
{
	data = iyreg;
}

//----------------------------------------------------------------------------------------
void Z80::SetIY(const Z80Word& data)
{
	iyreg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetSP() const
{
	return spreg;
}

//----------------------------------------------------------------------------------------
void Z80::GetSP(Data& data) const
{
	data = spreg;
}

//----------------------------------------------------------------------------------------
void Z80::SetSP(const Z80Word& data)
{
	spreg = data;
}

//----------------------------------------------------------------------------------------
Z80Word Z80::GetPC() const
{
	return pcreg;
}

//----------------------------------------------------------------------------------------
void Z80::GetPC(Data& data) const
{
	data = pcreg;
}

//----------------------------------------------------------------------------------------
void Z80::SetPC(const Z80Word& data)
{
	pcreg = data;
}

//----------------------------------------------------------------------------------------
void Z80::AddRefresh(unsigned int increase)
{
	rreg.SetDataSegment(0, 7, rreg.GetData() + increase);
}

//----------------------------------------------------------------------------------------
//Interrupt register functions
//----------------------------------------------------------------------------------------
unsigned int Z80::GetInterruptMode() const
{
	return interruptMode;
}

//----------------------------------------------------------------------------------------
void Z80::SetInterruptMode(unsigned int ainterruptMode)
{
	interruptMode = ainterruptMode % 4;
}

//----------------------------------------------------------------------------------------
bool Z80::GetIFF1() const
{
	return iff1;
}

//----------------------------------------------------------------------------------------
void Z80::SetIFF1(bool state)
{
	iff1 = state;
}

//----------------------------------------------------------------------------------------
bool Z80::GetIFF2() const
{
	return iff2;
}

//----------------------------------------------------------------------------------------
void Z80::SetIFF2(bool state)
{
	iff2 = state;
}

//----------------------------------------------------------------------------------------
bool Z80::GetMaskInterruptsNextOpcode() const
{
	return maskInterruptsNextOpcode;
}

//----------------------------------------------------------------------------------------
void Z80::SetMaskInterruptsNextOpcode(bool state)
{
	maskInterruptsNextOpcode = state;
}

//----------------------------------------------------------------------------------------
void Z80::SetProcessorStoppedState(bool astate)
{
	processorStopped = astate;
}

//----------------------------------------------------------------------------------------
//Flag functions
//	---------------------------------
//	| 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
//	|-------------------------------|
//	| S | Z |*Y | H |*X |P/V| N | C |
//	---------------------------------
//  *Undocumented
//----------------------------------------------------------------------------------------
bool Z80::GetFlagS() const
{
	return afreg.GetBit(7);
}

//----------------------------------------------------------------------------------------
void Z80::SetFlagS(bool flag)
{
	afreg.SetBit(7, flag);
}

//----------------------------------------------------------------------------------------
bool Z80::GetFlagZ() const
{
	return afreg.GetBit(6);
}

//----------------------------------------------------------------------------------------
void Z80::SetFlagZ(bool flag)
{
	afreg.SetBit(6, flag);
}

//----------------------------------------------------------------------------------------
bool Z80::GetFlagY() const
{
	return afreg.GetBit(5);
}

//----------------------------------------------------------------------------------------
void Z80::SetFlagY(bool flag)
{
	afreg.SetBit(5, flag);
}

//----------------------------------------------------------------------------------------
bool Z80::GetFlagH() const
{
	return afreg.GetBit(4);
}

//----------------------------------------------------------------------------------------
void Z80::SetFlagH(bool flag)
{
	afreg.SetBit(4, flag);
}

//----------------------------------------------------------------------------------------
bool Z80::GetFlagX() const
{
	return afreg.GetBit(3);
}

//----------------------------------------------------------------------------------------
void Z80::SetFlagX(bool flag)
{
	afreg.SetBit(3, flag);
}

//----------------------------------------------------------------------------------------
bool Z80::GetFlagPV() const
{
	return afreg.GetBit(2);
}

//----------------------------------------------------------------------------------------
void Z80::SetFlagPV(bool flag)
{
	afreg.SetBit(2, flag);
}

//----------------------------------------------------------------------------------------
bool Z80::GetFlagN() const
{
	return afreg.GetBit(1);
}

//----------------------------------------------------------------------------------------
void Z80::SetFlagN(bool flag)
{
	afreg.SetBit(1, flag);
}

//----------------------------------------------------------------------------------------
bool Z80::GetFlagC() const
{
	return afreg.GetBit(0);
}

//----------------------------------------------------------------------------------------
void Z80::SetFlagC(bool flag)
{
	afreg.SetBit(0, flag);
}

} //Close namespace Z80
